---
import MobileMenu from './MobileMenu.astro';
import { SITE_TITLE, COLORS, BREAKPOINTS, NAV_ITEMS, AUDIO_CONFIG } from '../consts';
---

<header>
	<div class="header-container">
		<a href="/" class="logo" aria-label={SITE_TITLE}>
			<img src="/img/favicon-96x96.png" alt={`${SITE_TITLE} Logo`} width="60" height="60">
		</a>
		<nav class="desktop-nav" aria-label="Main navigation">
			<ul>
				{NAV_ITEMS.map(({ href, key, label }) => (
					<li>
						<a href={href} data-translate={key}>{label}</a>
					</li>
				))}
				<li>
					<button id="languageToggle" class="lang-btn" aria-label="Toggle language">EN</button>
				</li>
			</ul>
		</nav>
		<div class="audio-controls" aria-label="Audio controls">
			<audio id="audioPlayer" style="display: none;">
				<source src={AUDIO_CONFIG.src} type={AUDIO_CONFIG.type}>
				Tu navegador no soporta el elemento de audio.
			</audio>
			<button id="playPauseBtn" class="audio-btn" aria-label="Play/Pause">‚ñ∂</button>
			<button id="muteBtn" class="audio-btn" aria-label="Mute/Unmute">üîä</button>
		</div>
		<MobileMenu />
	</div>
</header>

<style>
	header {
		background-color: #0011ff;
		box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		position: sticky;
		top: 0;
		z-index: 100;
		width: 100%;
	}

	.header-container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 1rem;
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.logo {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		text-decoration: none;
		color: #ff5100;
	}

	.logo img {
		transition: transform 0.3s ease;
	}

	.logo:hover img {
		transform: scale(1.05);
	}

	.desktop-nav ul {
		display: flex;
		list-style: none;
		margin: 0;
		padding: 0;
		gap: 2rem;
		align-items: center;
	}

	.desktop-nav a {
		text-decoration: none;
		color: #ff5100;
		font-weight: 500;
		padding: 0.5rem 1rem;
		border-radius: 4px;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		min-width: 100px;
	}

	.desktop-nav a:hover {
		background-color: rgba(255, 81, 0, 0.1);
	}

	.desktop-nav a.active {
		background-color: #ff5100;
		color: white;
	}

	.mobile-menu-button {
		display: none;
		background: none;
		border: none;
		color: #ff5100;
		font-size: 1.5rem;
		cursor: pointer;
		padding: 0.5rem;
	}

	.mobile-menu {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: var(--background-color);
		z-index: 1001;
		padding: 2rem;
		box-sizing: border-box;
	}

	.mobile-menu.active {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: 2rem;
	}

	.mobile-menu a {
		text-decoration: none;
		color: #ff5100;
		font-size: 1.5rem;
		font-weight: 500;
		padding: 1rem 2rem;
		border-radius: 4px;
		transition: all 0.3s ease;
		width: 100%;
		max-width: 200px;
		text-align: center;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.mobile-menu a:hover {
		background-color: rgba(255, 81, 0, 0.1);
	}

	.mobile-menu a.active {
		background-color: #ff5100;
		color: white;
	}

	.close-button {
		position: absolute;
		top: 1rem;
		right: 1rem;
		background: none;
		border: none;
		color: #ff5100;
		font-size: 1.5rem;
		cursor: pointer;
		padding: 0.5rem;
	}

	.audio-controls {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		margin: 0 1rem;
	}

	.audio-btn {
		background: none;
		border: 1px solid #ff5100;
		color: #ff5100;
		width: 32px;
		height: 32px;
		min-width: 32px;
		min-height: 32px;
		border-radius: 50%;
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 14px;
		transition: all 0.3s ease;
		padding: 0;
		margin: 0;
	}

	.audio-btn:hover,
	.audio-btn.playing {
		background: #ff5100;
		color: white;
	}

	.lang-btn {
		background: none;
		border: 1px solid #ff5100;
		color: #ff5100;
		padding: 0.3rem 0.6rem;
		border-radius: 4px;
		cursor: pointer;
		font-weight: 500;
		transition: all 0.3s ease;
		display: flex;
		align-items: center;
		justify-content: center;
		min-width: 40px;
	}

	.lang-btn:hover {
		background: #ff5100;
		color: white;
	}

	@media (max-width: 768px) {
		.desktop-nav {
			display: none;
		}

		.mobile-menu-button {
			display: block;
		}

		.audio-controls {
			margin: 0 0.5rem;
		}

		.audio-btn {
			width: 32px;
			height: 32px;
			min-width: 32px;
			min-height: 32px;
			font-size: 14px;
		}
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const menuButton = document.querySelector('.mobile-menu-button');
		const navLinks = document.querySelector('.nav-links');
		const languageToggle = document.getElementById('languageToggle');

		// Sistema de traducci√≥n
		const translations = {
			es: {
				'linktree': 'Linktree',
				'about': 'Acerca de',
				'home': 'Inicio',
				'poemas': 'Poemas',
				'historias': 'Historias',
				'frases': 'Frases',
				// Contenido de la p√°gina principal
				'greeting': 'Muy Buenas.',
				'introduction': 'Soy',
				'welcome_message': 'Bienvenido a mi blog personal. Aqu√≠ encontrar√°s mis pensamientos, proyectos y experiencias.',
				'things_to_do': 'Algunas cosas que puedes hacer aqu√≠:',
				'explore_texts': 'Explorar algunos textos en el blog',
				'about_me': 'Conocer m√°s sobre m√≠',
				'view_projects': 'Ver mis proyectos',
				'contact_follow': 'Contactarme o seguirme',
				// Otras traducciones existentes
				'welcome': 'Bienvenido',
				'read_more': 'Leer m√°s',
				'contact': 'Contacto',
				'follow_us': 'S√≠guenos',
				'latest_posts': '√öltimas publicaciones',
				'categories': 'Categor√≠as',
				'tags': 'Etiquetas',
				'search': 'Buscar',
				'archive': 'Archivo',
				'author': 'Autor',
				'date': 'Fecha',
				'comments': 'Comentarios',
				'share': 'Compartir',
				'related_posts': 'Publicaciones relacionadas',
				'back_to_top': 'Volver arriba',
				'footer_text': 'Todos los derechos reservados',
				// About page
				'about_me_intro': 'Mi nombre es Carlos, Carlos Moheno. Soy estudiante de la carrera \'Computaci√≥n Creativa\'. Tengo un poco de experiencia dise√±ando p√°ginas web y muy ligera en programaci√≥n con Java. Tengo 20 a√±os, me encanta la m√∫sica, los videojuegos, los c√≥mics, pel√≠culas, series, las caricaturas \'vintage\'. Me entusiasma mucho poder ayudar a la gente en la medida en la que me sea posible. Siempre que pueda brindar apoyo lo har√© sin dudarlo.',
				'about_me_image': 'Este soy yo',
				// Poems page
				'poems_title': 'Poemas',
				'poem_content': 'Tal vez ya te conozco,\nTal vez ya convivo contigo todos los d√≠as,\nTal vez s√© mucho de ti\nTal vez no.\n\nTal vez tu mirada me cautiva,\nTal vez tu presencia me hace el d√≠a,\nTal vez tu voz me da tranquilidad,\nTal vez no.\n\nTal vez Dios o el Universo me llevaron a conocerte,\nTal vez nuestra conexi√≥n se dio de manera natural,\nTal vez fue el destino,\nTal vez no.\n\nNo s√© si seas parte de mi vida o a√∫n no,\nCualquiera sea el caso, s√© que eres mi vida, mi luz,\nS√© que dar√≠a todo por ti y s√© que har√≠a todo por que seas feliz\nYa sea que eso signifique que sigas con o sin m√≠.',
				// Stories page
				'stories_title': 'Historias',
				'story_content': '"¬øHago lo suficiente por aquellos que me importan?" \n\nEs algo que un chico se pregunta todos los d√≠as de su vida. \nEste chico tiene un d√≠a como el de casi cualquier chico de 19 a√±os: se levanta temprano, se da un ba√±o, se viste, desayuna, se cepilla los dientes, se va a la escuela, est√° presente en clase, convive, regresa a casa, descansa un poco, hace tarea, se duerme y repite durante 4 d√≠as a la semana este mismo proceso, con variaciones, pero a grandes rasgos es eso. \n\nAlgo que ha podido entender con los a√±os es que el mundo y la vida son como una escuela que dura desde que nacemos hasta que, inevitablemente, descansamos... \n¬øC√≥mo se explica esto? Bueno, en el sentido de que cada d√≠a, hora, minuto, segundo o momento que vivimos y con quienes lo hacemos, nos ense√±a una lecci√≥n important√≠sima. Este chico cre√© firmemente que todo sucede por algo, pero a la vez esto genera en √©l mucha ansiedad de cierta forma. Teme mucho en las lecciones y aprendizajes que √©l mismo puede brindar a la gente. Sabe que no quiere ser una de esas lecciones que duelen, sino una que pueda darle esperanza a los dem√°s, y sabe que para lograrlo hay tres factores de suma importancia a tomar en cuenta: el valor, la sabidur√≠a y el poder. \n\nSi uno lo piensa bien, es f√°cil percatarse que estos tres elementos tienen una importancia vital en cada una de las elecciones que tomamos. La sabidur√≠a nos gu√≠a qu√© camino tomar en cada situaci√≥n. El poder nos otorga la posibilidad de tomar dicha elecci√≥n o realizar cierta acci√≥n. El valor nos ense√±a que tan capaces o que tan dispuestos estamos a llevar nuestras acciones a cabo. Dicho tres elementos son como fotograf√≠as que llevamos a todos lados y que, si nos tomamos un momento para volverlas a ver, nos pueden revelar mucho. \n\nEl chico s√≥lo sabe una cosa, quiere ser alguien que ayude a otros, y para lograrlo sabe que, s√≥lo tom√°ndose un momento para analizar c√≥mo actuar d√≠a a d√≠a, siempre sobre la mesa est√°n las 3 fotograf√≠as.',
				// Quotes page
				'quotes_title': 'Frases',
				'quote_content': 'La valent√≠a no es la ausencia del miedo.\nEs sentir el miedo y a√∫n as√≠ hacerlo.',
				'more_texts_coming_soon': 'M√°s textos pr√≥ximamente...'
			},
			en: {
				'linktree': 'Linktree',
				'about': 'About',
				'home': 'Home',
				'poemas': 'Poems',
				'historias': 'Stories',
				'frases': 'Quotes',
				// Main page content
				'greeting': 'Hello.',
				'introduction': 'I am',
				'welcome_message': 'Welcome to my personal blog. Here you will find my thoughts, projects, and experiences.',
				'things_to_do': 'Some things you can do here:',
				'explore_texts': 'Explore some texts in the blog',
				'about_me': 'Learn more about me',
				'view_projects': 'View my projects',
				'contact_follow': 'Contact or follow me',
				// Other existing translations
				'welcome': 'Welcome',
				'read_more': 'Read more',
				'contact': 'Contact',
				'follow_us': 'Follow us',
				'latest_posts': 'Latest posts',
				'categories': 'Categories',
				'tags': 'Tags',
				'search': 'Search',
				'archive': 'Archive',
				'author': 'Author',
				'date': 'Date',
				'comments': 'Comments',
				'share': 'Share',
				'related_posts': 'Related posts',
				'back_to_top': 'Back to top',
				'footer_text': 'All rights reserved',
				// About page
				'about_me_intro': 'My name is Carlos, Carlos Moheno. I am a student of the \'Creative Computing\' degree. I have some experience designing web pages and very light experience in Java programming. I am 20 years old, I love music, video games, comics, movies, series, \'vintage\' cartoons. I am very excited to be able to help people as much as possible. Whenever I can provide support, I will do so without hesitation.',
				'about_me_image': 'This is me',
				// Poems page
				'poems_title': 'Poems',
				'poem_content': 'Maybe I already know you,\nMaybe I already spend every day with you,\nMaybe I know a lot about you\nMaybe not.\n\nMaybe your gaze captivates me,\nMaybe your presence makes my day,\nMaybe your voice gives me peace,\nMaybe not.\n\nMaybe God or the Universe led me to meet you,\nMaybe our connection happened naturally,\nMaybe it was destiny,\nMaybe not.\n\nI don\'t know if you are part of my life or not yet,\nIn any case, I know you are my life, my light,\nI know I would give everything for you and I know I would do everything to make you happy\nWhether that means you stay with or without me.',
				// Stories page
				'stories_title': 'Stories',
				'story_content': '"Do I do enough for those who matter to me?" \n\nIt\'s something a boy asks himself every day of his life. \nThis boy has a day like almost any 19-year-old boy: he wakes up early, takes a bath, gets dressed, has breakfast, brushes his teeth, goes to school, is present in class, socializes, returns home, rests a bit, does homework, goes to sleep and repeats this same process for 4 days a week, with variations, but that\'s the gist of it. \n\nSomething he has been able to understand over the years is that the world and life are like a school that lasts from the moment we are born until we inevitably rest... \nHow is this explained? Well, in the sense that every day, hour, minute, second or moment we live and with whom we do it, teaches us an extremely important lesson. This boy firmly believes that everything happens for a reason, but at the same time this generates a lot of anxiety in him in a way. He fears greatly the lessons and learnings that he himself can provide to people. He knows he doesn\'t want to be one of those lessons that hurt, but rather one that can give hope to others, and he knows that to achieve this there are three factors of utmost importance to consider: courage, wisdom, and power. \n\nIf one thinks about it, it\'s easy to realize that these three elements have a vital importance in each of the choices we make. Wisdom guides us which path to take in each situation. Power gives us the possibility to make that choice or perform a certain action. Courage teaches us how capable or willing we are to carry out our actions. These three elements are like photographs that we carry everywhere and that, if we take a moment to look at them again, can reveal a lot to us. \n\nThe boy only knows one thing, he wants to be someone who helps others, and to achieve this he knows that, just by taking a moment to analyze how to act day by day, the 3 photographs are always on the table.',
				// Quotes page
				'quotes_title': 'Quotes',
				'quote_content': 'Courage is not the absence of fear.\nIt\'s feeling the fear and doing it anyway.',
				'more_texts_coming_soon': 'More texts coming soon...'
			}
		} as const;

		type TranslationKey = keyof typeof translations.es;
		let currentLang: 'es' | 'en' = localStorage.getItem('language') as 'es' | 'en' || 'es';

		// Funci√≥n para traducir todo el contenido
		function translatePage() {
			// Actualizar el bot√≥n
			if (languageToggle) {
				languageToggle.textContent = currentLang === 'es' ? 'EN' : 'ES';
			}
			
			// Traducir elementos con atributo data-translate
			document.querySelectorAll('[data-translate]').forEach(element => {
				const key = element.getAttribute('data-translate') as TranslationKey;
				if (key && key in translations[currentLang]) {
					element.textContent = translations[currentLang][key];
				}
			});

			// Traducir elementos con atributo data-translate-placeholder
			document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
				const key = element.getAttribute('data-translate-placeholder') as TranslationKey;
				if (key && key in translations[currentLang]) {
					(element as HTMLInputElement).placeholder = translations[currentLang][key];
				}
			});

			// Traducir elementos con atributo data-translate-title
			document.querySelectorAll('[data-translate-title]').forEach(element => {
				const key = element.getAttribute('data-translate-title') as TranslationKey;
				if (key && key in translations[currentLang]) {
					element.setAttribute('title', translations[currentLang][key]);
				}
			});

			// Traducir elementos con atributo data-translate-alt
			document.querySelectorAll('[data-translate-alt]').forEach(element => {
				const key = element.getAttribute('data-translate-alt') as TranslationKey;
				if (key && key in translations[currentLang]) {
					(element as HTMLImageElement).alt = translations[currentLang][key];
				}
			});
		}

		// Inicializar traducci√≥n
		translatePage();

		// Manejar cambio de idioma
		languageToggle?.addEventListener('click', () => {
			currentLang = currentLang === 'es' ? 'en' : 'es';
			localStorage.setItem('language', currentLang);
			translatePage();
		});

		menuButton?.addEventListener('click', () => {
			menuButton.classList.toggle('active');
			navLinks?.classList.toggle('active');
		});

		// Cerrar men√∫ al hacer clic en un enlace
		document.querySelectorAll('.nav-links a').forEach(link => {
			link.addEventListener('click', () => {
				menuButton?.classList.remove('active');
				navLinks?.classList.remove('active');
			});
		});

		// Control de audio
		const audioPlayer = document.getElementById('audioPlayer') as HTMLAudioElement;
		const playPauseBtn = document.getElementById('playPauseBtn');
		const muteBtn = document.getElementById('muteBtn');

		if (audioPlayer && playPauseBtn && muteBtn) {
			playPauseBtn.addEventListener('click', () => {
				if (audioPlayer.paused) {
					audioPlayer.play();
					playPauseBtn.textContent = '‚è∏';
					playPauseBtn.classList.add('playing');
				} else {
					audioPlayer.pause();
					playPauseBtn.textContent = '‚ñ∂';
					playPauseBtn.classList.remove('playing');
				}
			});

			muteBtn.addEventListener('click', () => {
				audioPlayer.muted = !audioPlayer.muted;
				muteBtn.textContent = audioPlayer.muted ? 'üîá' : 'üîä';
			});
		}
	});
</script>
